blueprint:
  name: ESPHome Wizmote Receiver - Generic Service Trigger
  domain: automation
  source_url: https://github.com/wongjustin99/wizmote-esphome/blob/main/wizmote-esphome-blueprint.yml
  input:
    remote:
      name: WizMote Mac address
      description: Mac address of the WizMote can be found by watching for
        the 'esphome.wizmote_choose' or 'esphome.wizmote_action' events
        as you press a button. (REMOVE all puncutation between letters/number, and ALL LOWERCASE only)
      selector:
        text:
    action_button_1:
      name: Action for Button 1
      description: Choose a service to trigger for button 1
      selector:
        action: {}
    action_button_2:
      name: Action for Button 2
      description: Choose a service to trigger for button 2
      selector:
        action: {}
    action_button_3:
      name: Action for Button 3
      description: Choose a service to trigger for button 3
      selector:
        action: {}
    action_button_4:
      name: Action for Button 4
      description: Choose a service to trigger for button 4
      selector:
        action: {}
    action_dim:
      name: Action for Dim Button
      description: Choose a service to trigger for the dim button
      selector:
        action: {}
    action_darker:
      name: Action for Darker Button
      description: Choose a service to trigger for the darker button
      selector:
        action: {}
    action_lighter:
      name: Action for Lighter Button
      description: Choose a service to trigger for the lighter button
      selector:
        action: {}
    action_on:
      name: Action for On Button
      description: Choose a service to trigger for the on button
      selector:
        action: {}
    action_off:
      name: Action for Off Button
      description: Choose a service to trigger for the off button
      selector:
        action: {}

mode: restart

trigger:
  - platform: event
    event_type: esphome.wizmote_choose
    event_data:
      mac: !input "remote"
  - platform: event
    event_type: esphome.wizmote_action
    event_data:
      mac: !input "remote"

action:
  - variables:
      button: "{{ trigger.event.data.button | int }}"
      event_type: "{{ trigger.event.event_type }}"

  # Handle actions for 'wizmote_choose' specifically for buttons 1, 2, 3, 4
  - choose:
      - conditions:
          - "{{ event_type == 'esphome.wizmote_choose' }}"
        sequence:
          - choose:
              - conditions:
                  - "{{ button == 1 }}"
                sequence:
                  - !input action_button_1
              - conditions:
                  - "{{ button == 2 }}"
                sequence:
                  - !input action_button_2
              - conditions:
                  - "{{ button == 3 }}"
                sequence:
                  - !input action_button_3
              - conditions:
                  - "{{ button == 4 }}"
                sequence:
                  - !input action_button_4

  # Handle actions for 'wizmote_action' for other buttons (including dim, on, off, etc.)
  - choose:
      - conditions:
          - "{{ event_type == 'esphome.wizmote_action' }}"
        sequence:
          - choose:
              - conditions:
                  - "{{ button == 1 }}"
                sequence:
                  - !input action_button_1
              - conditions:
                  - "{{ button == 2 }}"
                sequence:
                  - !input action_button_2
              - conditions:
                  - "{{ button == 3 }}"
                sequence:
                  - !input action_button_3
              - conditions:
                  - "{{ button == 4 }}"
                sequence:
                  - !input action_button_4
              - conditions:
                  - "{{ button == 5 }}"
                sequence:
                  - !input action_dim
              - conditions:
                  - "{{ button == 6 }}"
                sequence:
                  - !input action_darker
              - conditions:
                  - "{{ button == 7 }}"
                sequence:
                  - !input action_lighter
              - conditions:
                  - "{{ button == 8 }}"
                sequence:
                  - !input action_on
              - conditions:
                  - "{{ button == 9 }}"
                sequence:
                  - !input action_off
